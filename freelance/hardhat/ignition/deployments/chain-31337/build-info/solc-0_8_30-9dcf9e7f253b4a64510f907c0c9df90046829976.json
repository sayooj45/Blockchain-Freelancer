{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_30-9dcf9e7f253b4a64510f907c0c9df90046829976",
  "solcVersion": "0.8.30",
  "solcLongVersion": "0.8.30+commit.73712a01",
  "userSourceNameMap": {
    "contracts/PostJobs.sol": "project/contracts/PostJobs.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "prague",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/PostJobs.sol": {
        "content": "// SPDX-License-Identifier: MIT\npragma solidity 0.8.30;\n\ncontract postJob {\n    enum ApplicationStatus {\n        Pending, // 0\n        Accepted, // 1\n        Rejected // 2\n    }\n\n    struct jobPosting {\n        string title;\n        string description;\n        string budget;\n        string[] tools;\n    }\n\n    struct CompletedJobData {\n        address freelancer;\n        string jobId;\n        string budget;\n        uint256 timestamp;\n    }\n\n    string[] public jobIds;\n    mapping(string => jobPosting) public jobsposting;\n    mapping(string => address) public jobOwner;\n\n    // Job Application Status\n    mapping(address => string[]) public appliedJobs;\n    mapping(string => mapping(address => ApplicationStatus))\n        public applicationStatus;\n\n    // Job Completion and Payment Status\n    CompletedJobData[] public completedJobsList;\n    mapping(string => bool) public isJobCompleted;\n\n    mapping(string => mapping(address => bool)) public isJobPaid;\n\n    event Applied(address indexed user, string jobId);\n\n    event StatusUpdated(\n        address indexed user,\n        string indexed jobId,\n        ApplicationStatus newStatus\n    );\n\n    event JobCompleted(address indexed freelancer, string jobId, string budget);\n\n    event JobFinalizedAndPaid(\n        address indexed payer,\n        address indexed freelancer,\n        string jobId,\n        uint256 amount\n    );\n\n    function posting(\n        string memory _id,\n        string memory _title,\n        string memory _description,\n        string memory _budget,\n        string[] memory _tools\n    ) public {\n        require(\n            bytes(jobsposting[_id].title).length == 0,\n            \"Job ID already exists\"\n        );\n\n        jobsposting[_id] = jobPosting(_title, _description, _budget, _tools);\n        jobIds.push(_id);\n        jobOwner[_id] = msg.sender;\n    }\n\n    function totalJobs() public view returns (uint256) {\n        return jobIds.length;\n    }\n\n    function getJob(\n        string memory _id\n    )\n        public\n        view\n        returns (\n            string memory title,\n            string memory description,\n            string memory budget,\n            string[] memory tools\n        )\n    {\n        jobPosting storage j = jobsposting[_id];\n        return (j.title, j.description, j.budget, j.tools);\n    }\n\n    function applyJob(string memory _id) public {\n        string[] storage list = appliedJobs[msg.sender];\n        for (uint i = 0; i < list.length; i++) {\n            if (keccak256(bytes(list[i])) == keccak256(bytes(_id))) {\n                revert(\"Already Applied\");\n            }\n        }\n\n        list.push(_id);\n        applicationStatus[_id][msg.sender] = ApplicationStatus.Pending;\n\n        emit Applied(msg.sender, _id);\n    }\n\n    function getAppliedJobs(\n        address user\n    ) public view returns (string[] memory) {\n        return appliedJobs[user];\n    }\n\n    function getApplicationStatus(\n        string memory _id,\n        address _applicant\n    ) public view returns (ApplicationStatus) {\n        return applicationStatus[_id][_applicant];\n    }\n\n    // Function for the Job Owner to Accept/Reject\n    function updateApplicationStatus(\n        string memory _id,\n        address _applicant,\n        ApplicationStatus _newStatus\n    ) public {\n        require(jobOwner[_id] == msg.sender, \"Not the job owner\");\n        applicationStatus[_id][_applicant] = _newStatus;\n        emit StatusUpdated(_applicant, _id, _newStatus);\n    }\n\n    // This is called by the Freelancer when they finish the work\n    function completeJob(string memory _id) public {\n        require(!isJobCompleted[_id], \"Job is already completed\");\n\n        // 2. Check if the caller is the accepted freelancer\n        require(\n            applicationStatus[_id][msg.sender] == ApplicationStatus.Accepted,\n            \"You are not the accepted freelancer\"\n        );\n\n        // 3. Retrieve budget from the original job posting\n        jobPosting storage job = jobsposting[_id];\n        string memory _budget = job.budget;\n\n        // 4. Store the completion data\n        completedJobsList.push(\n            CompletedJobData({\n                freelancer: msg.sender,\n                jobId: _id,\n                budget: _budget,\n                timestamp: block.timestamp\n            })\n        );\n\n        // 5. Mark job as completed\n        isJobCompleted[_id] = true;\n\n        // 6. Emit event\n        emit JobCompleted(msg.sender, _id, _budget);\n    }\n\n    // Helper to get all completed jobs\n    function getAllCompletedJobs()\n        public\n        view\n        returns (CompletedJobData[] memory)\n    {\n        return completedJobsList;\n    }\n\n    /**\n     * @notice Called by the Job Owner to accept the work and transfer the payment to the freelancer.\n     * @param _id The job ID.\n     * @param _freelancer The address of the accepted freelancer.\n     */\n    function acceptWorkAndPay(\n        string memory _id,\n        address _freelancer\n    ) public payable {\n        // 1. Authorization and Status Checks\n        require(jobOwner[_id] == msg.sender, \"Not the job owner\");\n        require(\n            applicationStatus[_id][_freelancer] == ApplicationStatus.Accepted,\n            \"Freelancer not accepted\"\n        );\n        require(\n            isJobCompleted[_id],\n            \"Work has not been completed by freelancer\"\n        );\n        require(!isJobPaid[_id][_freelancer], \"Job is already paid\");\n\n        // The job owner must attach the payment value (msg.value) in the transaction.\n        uint256 paymentAmount = msg.value;\n\n        // 2. Transfer funds to the Freelancer\n        (bool success, ) = payable(_freelancer).call{value: paymentAmount}(\"\");\n        require(success, \"Payment transfer failed\");\n\n        isJobPaid[_id][_freelancer] = true;\n\n        emit JobFinalizedAndPaid(msg.sender, _freelancer, _id, paymentAmount);\n    }\n}\n"
      }
    }
  }
}